<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Registration | Bedusec Mega Organization</title>
    <link rel="stylesheet" href="auth-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="matrix-bg"></div>
    
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <div class="auth-logo">BEDUSEC</div>
                <div class="auth-subtitle">ORGANIZATION ACCOUNT CREATION</div>
                <div class="secure-connection">
                    <i class="fas fa-shield-alt"></i>
                    <span>Secure Encrypted Registration</span>
                </div>
            </div>

            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label" for="firstName">
                        <i class="fas fa-id-card"></i> LEGAL FIRST NAME
                    </label>
                    <input type="text" id="firstName" class="cyber-input" placeholder="Enter legal first name" required>
                    <div class="error-message" id="firstNameError"></div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="lastName">
                        <i class="fas fa-id-card"></i> LEGAL LAST NAME
                    </label>
                    <input type="text" id="lastName" class="cyber-input" placeholder="Enter legal last name" required>
                    <div class="error-message" id="lastNameError"></div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="company">
                        <i class="fas fa-building"></i> ORGANIZATION (OPTIONAL)
                    </label>
                    <input type="text" id="company" class="cyber-input" placeholder="Your company or organization">
                </div>

                <div class="form-group">
                    <label class="form-label" for="email">
                        <i class="fas fa-envelope"></i> ORGANIZATION EMAIL
                    </label>
                    <input type="email" id="email" class="cyber-input" placeholder="secure@yourorganization.com" required>
                    <div class="error-message" id="emailError"></div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="password">
                        <i class="fas fa-key"></i> ENCRYPTED PASSWORD
                    </label>
                    <div class="input-with-icon">
                        <input type="password" id="password" class="cyber-input" placeholder="Create strong encrypted password" required 
                               oninput="updatePasswordStrength(this.value, document.getElementById('passwordStrength'))">
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('password')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="password-strength" id="passwordStrength"></div>
                    <div class="error-message" id="passwordError"></div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="confirmPassword">
                        <i class="fas fa-key"></i> CONFIRM ENCRYPTED PASSWORD
                    </label>
                    <div class="input-with-icon">
                        <input type="password" id="confirmPassword" class="cyber-input" placeholder="Re-enter your encrypted password" required>
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('confirmPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="error-message" id="confirmPasswordError"></div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="role">
                        <i class="fas fa-user-tag"></i> SECURITY CLEARANCE LEVEL
                    </label>
                    <select id="role" class="cyber-input" required>
                        <option value="">Select your role</option>
                        <option value="security_analyst">Security Analyst</option>
                        <option value="penetration_tester">Penetration Tester</option>
                        <option value="security_consultant">Security Consultant</option>
                        <option value="researcher">Security Researcher</option>
                        <option value="executive">Executive</option>
                        <option value="partner">Partner</option>
                    </select>
                    <div class="error-message" id="roleError"></div>
                </div>

                <div class="form-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="terms" required>
                        <span class="toggle-slider"></span>
                        I accept the <a href="#" class="auth-link">Terms of Service</a> and <a href="#" class="auth-link">Privacy Policy</a>
                    </label>
                    <div class="error-message" id="termsError"></div>
                </div>

                <button type="submit" class="cyber-button" id="registerButton">
                    <i class="fas fa-user-shield"></i> CREATE SECURE ACCOUNT
                </button>
            </form>

            <div class="auth-footer">
                <p>Already have secure access? <a href="login-enhanced.html" class="auth-link">Initiate Secure Login</a></p>
            </div>

            <div class="security-features">
                <div class="security-title">
                    <i class="fas fa-shield-check"></i> ENHANCED SECURITY PROTOCOLS
                </div>
                <ul class="security-list">
                    <li>Military-Grade Encryption (AES-256)</li>
                    <li>Advanced Password Hashing (bcrypt)</li>
                    <li>Real-time Threat Intelligence</li>
                    <li>Automated Security Auditing</li>
                    <li>Multi-Layer Authentication</li>
                    <li>Session Management & Monitoring</li>
                </ul>
            </div>
        </div>
    </div>

    <script src="auth-enhanced.js"></script>
    <script>
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                company: document.getElementById('company').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value,
                confirmPassword: document.getElementById('confirmPassword').value,
                role: document.getElementById('role').value,
                terms: document.getElementById('terms').checked
            };

            // Clear previous errors
            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');

            const validation = validateForm(formData);

            if (!formData.terms) {
                document.getElementById('termsError').textContent = 'You must accept the terms and conditions';
                validation.isValid = false;
            }

            if (!formData.role) {
                document.getElementById('roleError').textContent = 'Please select your security clearance level';
                validation.isValid = false;
            }

            if (formData.password !== formData.confirmPassword) {
                document.getElementById('confirmPasswordError').textContent = 'Passwords do not match';
                validation.isValid = false;
            }

            if (!validation.isValid) {
                Object.entries(validation.errors).forEach(([field, error]) => {
                    document.getElementById(`${field}Error`).textContent = error;
                });
                return;
            }

            const button = document.getElementById('registerButton');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading"></div> CREATING SECURE ACCOUNT...';
            button.disabled = true;

            try {
                await authSystem.register(formData);
                // Redirect to verification page or show success message
                setTimeout(() => {
                    window.location.href = 'login-enhanced.html?message=registration_success';
                }, 2000);
            } catch (error) {
                // Error handling is done in authSystem.register()
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        });

        // Real-time validation
        document.getElementById('email').addEventListener('blur', function() {
            if (this.value && !validateEmail(this.value)) {
                document.getElementById('emailError').textContent = 'Please enter a valid organization email';
            } else {
                document.getElementById('emailError').textContent = '';
            }
        });

        document.getElementById('confirmPassword').addEventListener('input', function() {
            const password = document.getElementById('password').value;
            if (this.value && password !== this.value) {
                document.getElementById('confirmPasswordError').textContent = 'Passwords do not match';
            } else {
                document.getElementById('confirmPasswordError').textContent = '';
            }
        });
    </script>
</body>
</html>
